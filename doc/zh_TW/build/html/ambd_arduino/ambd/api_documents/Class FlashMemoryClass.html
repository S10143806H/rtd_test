

<!DOCTYPE html>
<html class="writer-html5" lang="zh-TW" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Class EpdIF &mdash; amebaDoc 0.0.1 說明文件</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜尋" href="../../../search.html" />
    <link rel="next" title="Class DHT" href="Class%20DHT.html" />
    <link rel="prev" title="Class EpdIF" href="Class%20EpdIF.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> amebaDoc
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">開源開發平台:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arduino_index.html">Arduino 開發平台</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ambd_micropython/source/index.html">Micropython 開發平台</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ambd_sdk/source/index.html">Standard SDK</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">amebaDoc</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../arduino_index.html">Arduino 開發平台</a> &raquo;</li>
        
          <li><a href="../index.html">RTL8722DM</a> &raquo;</li>
        
          <li><a href="index.html">API 指南</a> &raquo;</li>
        
      <li>Class EpdIF</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/ambd_arduino/ambd/api_documents/Class FlashMemoryClass.rst.txt" rel="nofollow"> 查看页面源码</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="class-epdif">
<h1>Class EpdIF<a class="headerlink" href="#class-epdif" title="本標題的永久連結">¶</a></h1>
<p><strong>FlashMemoryClass Class</strong></p>
<div class="line-block">
<div class="line"><strong>Description</strong></div>
<div class="line">Defines a class of Flash memory API</div>
</div>
<div class="line-block">
<div class="line"><strong>Syntax</strong></div>
<div class="line">class FlashMemoryClass</div>
</div>
<p><strong>Members</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Public Constructors</strong></p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Fl
ashMemoryClass::FlashMemoryClass</p></td>
<td><p>Constructs a FlashMemoryClass
object</p></td>
</tr>
<tr class="row-odd"><td><p>Fla
shMemoryClass::~FlashMemoryClass</p></td>
<td><p>Deconstructs a FlashMemoryClass
object</p></td>
</tr>
<tr class="row-even"><td><p><strong>Public Methods</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>FlashMemoryClass::begin</p></td>
<td><p>Initialize/Re-initialize the
base address and size</p></td>
</tr>
<tr class="row-even"><td><p>FlashMemoryClass::read</p></td>
<td><p>Read the content to buf</p></td>
</tr>
<tr class="row-odd"><td><p>FlashMemoryClass::update</p></td>
<td><p>Write buf back to flash memory</p></td>
</tr>
<tr class="row-even"><td><p>FlashMemoryClass::readWord</p></td>
<td><p>Read 4 bytes from flash memory</p></td>
</tr>
<tr class="row-odd"><td><p>FlashMemoryClass::writeWord</p></td>
<td><p>Write 4 bytes into flash memory</p></td>
</tr>
<tr class="row-even"><td><p>FlashMemoryClass::buf_size</p></td>
<td><p>The buf size</p></td>
</tr>
<tr class="row-odd"><td><p>FlashMemoryClass::<a href="#id1"><span class="problematic" id="id2">*</span></a>buf</p></td>
<td><p>The buf to be operated</p></td>
</tr>
</tbody>
</table>
<p><strong>FlashMemoryClass::FlashMemoryClass</strong></p>
<div class="line-block">
<div class="line"><strong>Description</strong></div>
<div class="line">Constructs a FlashMemoryClass object.</div>
</div>
<div class="line-block">
<div class="line"><strong>Syntax</strong></div>
<div class="line">FlashMemoryClass(unsigned int _base_address, unsigned int
_buf_size);</div>
</div>
<div class="line-block">
<div class="line"><strong>Parameters</strong></div>
<div class="line">_base_address: The base address to operate.</div>
<div class="line">_buf_size: The buf size for mirror a copy to reduce flash memory
operation</div>
</div>
<div class="line-block">
<div class="line"><strong>Returns</strong></div>
<div class="line">The function returns nothing.</div>
</div>
<div class="line-block">
<div class="line"><strong>Example Code</strong></div>
<div class="line">Example: FleshMemory_Basic</div>
<div class="line">This example demonstrates the basic use of flash memory. Since boot
count is stored in flash, each time upon device boot up, the boot
count will be read from the flash, add one, then write back to the
flash. Ameba’s flash memory can be edit in a unit of a sector which
has the size of 4K bytes.</div>
<div class="line">Direct read from flash memory is allowed. To write data into flash
memory, each bit on flash memory can only change from ‘1’ to ‘0’ and
it cannot change from ‘0’ to ‘1’. To make sure the data are correctly
written we do erase the flash memory sector before write data on it.</div>
</div>
<p><strong>#include &lt;FlashMemory.h&gt;</strong></p>
<p><strong>void</strong> setup() {</p>
<p>FlashMemory.read();</p>
<p><strong>if</strong> (FlashMemory.buf[0] == <em>0xFF</em>) {</p>
<p>FlashMemory.buf[0] = <em>0x00</em>;</p>
<p>FlashMemory.update();</p>
<p>Serial.println(「write count to 0」);</p>
<p>} <strong>else</strong> {</p>
<p>FlashMemory.buf[0]++;</p>
<p>FlashMemory.update();</p>
<p>Serial.print(「Boot count: 「);</p>
<p>Serial.println(FlashMemory.buf[0]);</p>
<p>}</p>
<p>}</p>
<p><strong>void</strong> loop() {</p>
<p>delay(1000);</p>
<p>}</p>
<div class="line-block">
<div class="line">Example: ReadWriteOneWord</div>
<div class="line">This example shows how to request flash memory larger than default
0x4000, and read/write one specific word (32-bit).</div>
</div>
<p><strong>#include &lt;FlashMemory.h&gt;</strong></p>
<p><strong>void</strong> setup() {</p>
<p>unsigned <strong>int</strong> value;</p>
<p>/* request flash size 0x4000 from 0xFC000 */</p>
<p>FlashMemory.begin(<em>0xFC000</em>, <em>0x4000</em>);</p>
<p>/* read one word (32-bit) from 0xFC000 plus offset 0x3F00 */</p>
<p>value = FlashMemory.readWord(<em>0x3F00</em>);</p>
<p>printf(「value is 0x%08Xrn」, value);</p>
<p><strong>if</strong> (value == <em>0xFFFFFFFF</em>) {</p>
<p>value = 0;</p>
<p>} <strong>else</strong> {</p>
<p>value++;</p>
<p>}</p>
<p>/* write one word (32-bit) to 0xFC000 plus offset 0x3F00 */</p>
<p>FlashMemory.writeWord(<em>0x3F00</em>, value);</p>
<p>}</p>
<p><strong>void</strong> loop() {</p>
<p>// put your main code here, to run repeatedly:</p>
<p>}</p>
<div class="line-block">
<div class="line"><strong>Notes and Warnings</strong></div>
<div class="line">Include “FlashMemory.h” to use the class function.</div>
<div class="line"><br /></div>
</div>
<p><strong>FlashMemoryClass::begin</strong></p>
<div class="line-block">
<div class="line"><strong>Description</strong></div>
<div class="line">Initialize/Re-initialize the base address and size. The base address
shell aligns with the size of 0x1000. And the size shell is multiple
of 0x1000.</div>
</div>
<div class="line-block">
<div class="line"><strong>Syntax</strong></div>
<div class="line">void begin(unsigned int _base_address, unsigned int _buf_size);</div>
</div>
<div class="line-block">
<div class="line"><strong>Parameters</strong></div>
<div class="line">_base_address: The base address</div>
<div class="line">_buf_size: The desired work size</div>
</div>
<div class="line-block">
<div class="line"><strong>Returns</strong></div>
<div class="line">The function returns nothing.</div>
</div>
<div class="line-block">
<div class="line"><strong>Example Code</strong></div>
<div class="line">Example: FleshMemory_Basic</div>
<div class="line">This example demonstrates the basic use of flash memory. Since boot
count is stored in flash, each time upon device boot up, the boot
count will be read from the flash, add one, then write back to the
flash. Ameba’s flash memory can be edit in a unit of a sector which
has the size of 4K bytes.</div>
<div class="line">Example: ReadWriteOneWord</div>
<div class="line">This example shows how to request flash memory larger than default
0x4000, and read/write one specific word (32-bit).</div>
<div class="line">Details of the example codes can be found in the previous section of
“FlashMemoryClass:: FlashMemoryClass”.</div>
</div>
<div class="line-block">
<div class="line"><strong>Notes and Warnings</strong></div>
<div class="line">Include “FlashMemory.h” to use the class function.</div>
<div class="line"><br /></div>
</div>
<p><strong>FlashMemoryClass::read</strong></p>
<div class="line-block">
<div class="line"><strong>Description</strong></div>
<div class="line">Read the content to buf. Read flash memory into the buf. The size
would be 0x1000.</div>
</div>
<div class="line-block">
<div class="line"><strong>Syntax</strong></div>
<div class="line">void read(void);</div>
</div>
<div class="line-block">
<div class="line"><strong>Parameters</strong></div>
<div class="line">The function requires no input parameter.</div>
</div>
<div class="line-block">
<div class="line"><strong>Returns</strong></div>
<div class="line">The function returns nothing.</div>
</div>
<div class="line-block">
<div class="line"><strong>Example Code</strong></div>
<div class="line">Example: FleshMemory_Basic</div>
<div class="line">This example demonstrates the basic use of flash memory. Since boot
count is stored in flash, each time upon device boot up, the boot
count will be read from the flash, add one, then write back to the
flash. Ameba’s flash memory can be edit in a unit of a sector which
has the size of 4K bytes.</div>
<div class="line">Details of the example codes can be found in the previous section of
“FlashMemoryClass:: FlashMemoryClass”.</div>
</div>
<div class="line-block">
<div class="line"><strong>Notes and Warnings</strong></div>
<div class="line">Include “FlashMemory.h” to use the class function.</div>
<div class="line"><br /></div>
</div>
<p><strong>FlashMemoryClass::update</strong></p>
<div class="line-block">
<div class="line"><strong>Description</strong></div>
<div class="line">Write buf back to flash memory. Write flash memory with the content of
the buffer. The size is 0x1000.</div>
</div>
<div class="line-block">
<div class="line"><strong>Syntax</strong></div>
<div class="line">void update(bool erase = true);</div>
</div>
<div class="line-block">
<div class="line"><strong>Parameters</strong></div>
<div class="line">erase: By default, it is true and erases flash memory before writing
to it</div>
</div>
<div class="line-block">
<div class="line"><strong>Returns</strong></div>
<div class="line">The function returns nothing.</div>
</div>
<div class="line-block">
<div class="line"><strong>Example Code</strong></div>
<div class="line">Example: FleshMemory_Basic</div>
<div class="line">This example demonstrates the basic use of flash memory. Since boot
count is stored in flash, each time upon device boot up, the boot
count will be read from the flash, add one, then write back to the
flash. Ameba’s flash memory can be edit in a unit of a sector which
has the size of 4K bytes.</div>
<div class="line">Details of the example codes can be found in the previous section of
“FlashMemoryClass:: FlashMemoryClass”.</div>
</div>
<div class="line-block">
<div class="line"><strong>Notes and Warnings</strong></div>
<div class="line">Include “FlashMemory.h” to use the class function.</div>
<div class="line"><br /></div>
</div>
<p><strong>FlashMemoryClass::readWord</strong></p>
<div class="line-block">
<div class="line"><strong>Description</strong></div>
<div class="line">Read 4 bytes from flash memory. Read 4 byte from specific offset based
on base address.</div>
</div>
<div class="line-block">
<div class="line"><strong>Syntax</strong></div>
<div class="line">unsigned int readWord(unsigned int offset);</div>
</div>
<div class="line-block">
<div class="line"><strong>Parameters</strong></div>
<div class="line">offset: The offset according to the base address</div>
</div>
<div class="line-block">
<div class="line"><strong>Returns</strong></div>
<div class="line">The read data with a size of 4 bytes</div>
</div>
<div class="line-block">
<div class="line"><strong>Example Code</strong></div>
<div class="line">Example: ReadWriteOneWord</div>
<div class="line">This example shows how to request flash memory larger than default
0x4000, and read/write one specific word (32-bit).</div>
<div class="line">Details of the example codes can be found in the previous section of
“FlashMemoryClass:: FlashMemoryClass”.</div>
</div>
<div class="line-block">
<div class="line"><strong>Notes and Warnings</strong></div>
<div class="line">Include “FlashMemory.h” to use the class function.</div>
<div class="line"><br /></div>
</div>
<p><strong>FlashMemoryClass::writeWord</strong></p>
<div class="line-block">
<div class="line"><strong>Description</strong></div>
<div class="line">Write 4 bytes into flash memory. It will try to write 4 bytes first.
If the read data differ from the write data, then we buffer the sector
of flash memory, erase it, and write correct data back to it.</div>
</div>
<div class="line-block">
<div class="line"><strong>Syntax</strong></div>
<div class="line">void writeWord(unsigned int offset, unsigned int data);</div>
</div>
<div class="line-block">
<div class="line"><strong>Parameters</strong></div>
<div class="line">offset: The offset according to the base address</div>
<div class="line">data: The data to be written</div>
</div>
<div class="line-block">
<div class="line"><strong>Returns</strong></div>
<div class="line">The function returns nothing.</div>
</div>
<div class="line-block">
<div class="line"><strong>Example Code</strong></div>
<div class="line">Example: ReadWriteOneWord</div>
<div class="line">This example shows how to request flash memory larger than default
0x4000, and read/write one specific word (32-bit).</div>
<div class="line">Details of the example codes can be found in the previous section of
“FlashMemoryClass:: FlashMemoryClass”.</div>
</div>
<div class="line-block">
<div class="line"><strong>Notes and Warnings</strong></div>
<div class="line">Include “FlashMemory.h” to use the class function.</div>
<div class="line"><br /></div>
</div>
<p><strong>FlashMemoryClass::buf_size</strong></p>
<div class="line-block">
<div class="line"><strong>Description</strong></div>
<div class="line">The buf size (It can be regarded as work size).</div>
</div>
<div class="line-block">
<div class="line"><strong>Syntax</strong></div>
<div class="line">unsigned int buf_size;</div>
</div>
<div class="line-block">
<div class="line"><strong>Example Code</strong></div>
<div class="line">Example: FlashMemory_Basic</div>
<div class="line">This example demonstrates the basic use of flash memory. Since boot
count is stored in flash, each time upon device boot up, the boot
count will be read from the flash, add one, then write back to the
flash. Ameba’s flash memory can be edit in a unit of a sector which
has the size of 4K bytes.</div>
<div class="line">Details of the example codes can be found in the previous section of
“FlashMemoryClass:: FlashMemoryClass”.</div>
</div>
<div class="line-block">
<div class="line"><strong>Notes and Warnings</strong></div>
<div class="line">Include “FlashMemory.h” to use the class function.</div>
<div class="line"><br /></div>
</div>
<p><strong>FlashMemoryClass::*buf</strong></p>
<div class="line-block">
<div class="line"><strong>Description</strong></div>
<div class="line">The buf to be operated. Modify buf won’t change the content of the
buf. It needs an update to write back to flash memory.</div>
</div>
<div class="line-block">
<div class="line"><strong>Syntax</strong></div>
<div class="line">unsigned char *buf;</div>
</div>
<div class="line-block">
<div class="line"><strong>Example Code</strong></div>
<div class="line">NA</div>
</div>
<div class="line-block">
<div class="line"><strong>Notes and Warnings</strong></div>
<div class="line">Include “FlashMemory.h” to use the class function.</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Class%20DHT.html" class="btn btn-neutral float-right" title="Class DHT" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Class%20EpdIF.html" class="btn btn-neutral float-left" title="Class EpdIF" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; 版權所有 2021, Ameba IoT。

    </p>
  </div>
    
    
    
    利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    
    由 <a href="https://readthedocs.org">Read the Docs</a>开发. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>