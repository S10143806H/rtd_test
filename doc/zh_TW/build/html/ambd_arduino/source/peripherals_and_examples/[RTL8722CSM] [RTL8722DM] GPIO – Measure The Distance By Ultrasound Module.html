

<!DOCTYPE html>
<html class="writer-html5" lang="zh-TW" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>[RTL8722CSM] [RTL8722DM] GPIO – Measure The Distance By Ultrasound Module &mdash; amebaDoc 0.0.1 說明文件</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜尋" href="../../../search.html" />
    <link rel="next" title="[RTL8722CSM] [RTL8722DM] GPIO - Measuring The Temperature And Humidity" href="%5BRTL8722CSM%5D%20%5BRTL8722DM%5D%20GPIO%20-%20Measuring%20The%20Temperature%20And%20Humidity.html" />
    <link rel="prev" title="周邊設備示例" href="Peripheral%20Examples.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> amebaDoc
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">開源開發平台:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arduino_index.html">Arduino 開發平台</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ambd_micropython/source/index.html">Micropython SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ambd_sdk/source/index.html">Standard SDK</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">amebaDoc</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../arduino_index.html">Arduino 開發平台</a> &raquo;</li>
        
          <li><a href="../index.html">RTL8722DM</a> &raquo;</li>
        
          <li><a href="index.html">周邊設備和示例</a> &raquo;</li>
        
          <li><a href="Peripheral%20Examples.html">周邊設備示例</a> &raquo;</li>
        
      <li>[RTL8722CSM] [RTL8722DM] GPIO – Measure The Distance By Ultrasound Module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/ambd_arduino/source/peripherals_and_examples/[RTL8722CSM] [RTL8722DM] GPIO – Measure The Distance By Ultrasound Module.rst.txt" rel="nofollow"> 查看页面源码</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rtl8722csm-rtl8722dm-gpio-measure-the-distance-by-ultrasound-module">
<h1>[RTL8722CSM] [RTL8722DM] GPIO – Measure The Distance By Ultrasound Module<a class="headerlink" href="#rtl8722csm-rtl8722dm-gpio-measure-the-distance-by-ultrasound-module" title="本標題的永久連結">¶</a></h1>
<p>Preparation</p>
<ul class="simple">
<li><p>Ameba x 1</p></li>
<li><p>HC-SR04 Ultrasonic x 1</p></li>
<li><p>Dropping resistor or Level converter</p></li>
</ul>
<p>Example</p>
<p>HC-SR04 is a module that uses ultrasound to measure the distance. It
looks like a pair of eyes in its appearance, therefore it’s often
installed onto robot-vehicle or mechanical bugs to be their eyes. The
way it works is that first we “toggle high” the TRIG pin (that is to
pull high then pull low). The HC-SR04 would send eight 40kHz sound wave
signal and pull high the ECHO pin. When the sound wave returns back, it
pull low the ECHO pin.<a class="reference internal" href="../../../_images/image1116.png"><img alt="1" src="../../../_images/image1116.png" style="width: 6.5in; height: 4.00417in;" /></a>Assume the velocity of sound is 340 m/s,
the time it takes for the sound to advance 1 cm in the air is
340*100*10^-6 = 29 us。 The sound wave actually travels twice the
distance between HC-SR04 and the object, therefore the distance can be
calculated by (time/29) / 2 = time / 58。 The working voltage of HC-SR04
is 5V. When we pull high the ECHO pin to 5V, the voltage might cause
damage to the GPIO pin of Ameba. To avoid this situation, we need to
drop the voltage as follows:<a class="reference internal" href="../../../_images/image298.png"><img alt="2" src="../../../_images/image298.png" style="width: 6.5in; height: 4.74306in;" /></a>We pick the resistors with resistance
1:2, in the example we use 10kΩ and 20kΩ. If you do not have resistors
in hand, you can use level converter instead.The TXB0108 8 channel level
converter is a suitable example:<a class="reference internal" href="../../../_images/image364.png"><img alt="3" src="../../../_images/image364.png" style="width: 6.5in; height: 4.99375in;" /></a>Next, open the sample code in
“File” -&gt; “Examples” -&gt; “AmebaGPIO” -&gt;
“HCSR04_Ultrasonic”<a class="reference internal" href="../../../_images/image455.png"><img alt="image1" src="../../../_images/image455.png" style="width: 6.5in; height: 4.99375in;" /></a>Compile and upload to Ameba, then press
the reset button. Open the Serial Monitor, the calculated result is
output to serial monitor every 2 seconds.<a class="reference internal" href="../../../_images/image531.png"><img alt="4" src="../../../_images/image531.png" style="width: 5.38958in; height: 9in;" /></a>Note that the HCSR04
module uses the reflection of sound wave to calculate the distance, thus
the result can be affected by the surface material of the object (e.g.,
harsh surface tends to cause scattering of sound wave, and soft surface
may cause the sound wave to be absorbed).</p>
<p>Code Reference</p>
<p>Before the measurement starts, we need to pull high the TRIG pin for
10us and then pull low. By doing this, we are telling the HC-SR04 that
we are about to start the measurement:</p>
<p>digitalWrite(trigger_pin, HIGH);</p>
<p>delayMicroseconds(10);</p>
<p>digitalWrite(trigger_pin, LOW);</p>
<p>Next, use pulseIn to measure the time when the ECHO pin is pulled high.</p>
<p>duration = pulseIn (echo_pin, HIGH);</p>
<p>Finally, use the formula to calculate the distance.</p>
<p>distance = duration / 58;</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="%5BRTL8722CSM%5D%20%5BRTL8722DM%5D%20GPIO%20-%20Measuring%20The%20Temperature%20And%20Humidity.html" class="btn btn-neutral float-right" title="[RTL8722CSM] [RTL8722DM] GPIO - Measuring The Temperature And Humidity" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Peripheral%20Examples.html" class="btn btn-neutral float-left" title="周邊設備示例" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; 版權所有 2021, Ameba IoT。

    </p>
  </div>
    
    
    
    利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    
    由 <a href="https://readthedocs.org">Read the Docs</a>开发. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>